/*! JTaro.js v0.1.0 ~ (c) 2016 Author:BarZu Git:https://github.com/chjtx/JTaro */
!function(n,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):n.JTaro=e()}(this,function(){"use strict";var n=Object.create(null);return n.install=function(e,o){function t(e,o){var t=e.options.beforeEnter;"function"==typeof t?t.call(n,function(n){o(n)})&&o():o()}function i(n){var o=e.options.components[n.jtaro_tag].options.afterEnter;"function"==typeof o&&o.call(n)}function l(n,o){var t=e.options.components[n.$parent.jtaro_tag].options.beforeLeave;"function"==typeof t?t.call(n,function(){o()})&&o():o()}function a(e,o){var t=e.$el,l=t.previousElementSibling;n.method&&n.method.call(e,e),n.sliding=!0,o.utils.moveTo(t,h,0),setTimeout(function(){l&&o.utils.moveTo(l,-h,0,300,function(){var n=l.previousElementSibling;n&&(n.style.display="none")}),o.utils.moveTo(t,0,0,300,function(){n.sliding=!1,i(e)})},0)}function r(e,o,t){var i=e.nextElementSibling;n.sliding=!0,i&&o.utils.moveTo(i,h,0,300,t),o.utils.moveTo(e,0,0,300,function(){n.sliding=!1;var o=e.previousElementSibling;o&&(o.style.display="block")})}function s(n,e,o,t){var l=n.length;l-1>t&&r(e[l-2],o,function(){n.splice(l-1),e[l-1].parentNode.removeChild(e[l-1]),setTimeout(function(){s(n,e,o,t)},0)}),l-1===t&&i(c(n[t]))}function d(n){var e=n.split("&"),o={};return e.forEach(function(n){var e=n.split("=");o[e[0]]=e[1]}),o}function c(e){for(var o=n.vm.$children,t=0,i=o.length;t<i;t++)if(o[t].jtaro_tag===e)return o[t]}function u(e,o){var t=e.replace("#!","").split("?")[0],i=n.vm.$data.views,l=n.views.indexOf(t),r=c(t);l===-1?(i.indexOf(t)===-1?i.push(t):(n.vm.$el.appendChild(r.$el),a(r,o)),n.views.push(t)):(n.method&&n.method.call(r,r),s(n.views,n.vm.$el.childNodes,o,l))}function p(){h=window.innerWidth}var v=document.getElementById("jtaro_style");v||(v=document.createElement("style"),v.id="jtaro_style",v.innerHTML="html,body{height:100%;padding:0;margin:0}#jtaro_app{position:relative;width:100%;height:100%;overflow:hidden}.jtaro-view{position:absolute;width:100%;height:100%;overflow:hidden;background:#fff}",document.head.appendChild(v));var f={template:'<div style="text-align:center;padding-top:100px">404 Page not found</div>'},h=window.innerWidth;n.params=null,n.views=[],n.version="0.1.0";var m={props:["view"],data:function(){return{jtaro_tag:this.view}},render:function(n){return n(e.options.components[this.view]||f)},mounted:function(){a(this,o.jroll)}};e.component("jt-view",m),e.prototype.postMessage=function(n,o){var t=c(o),i=e.options.components[o],l=i?i.options.onMessage:null;t&&l&&l.call(t.$children[0],{message:n,origin:this.$parent.jtaro_tag})},e.prototype.go=function(o,i){n.sliding||l(this,function(){var l=o.replace("#!",""),a=l.split("?");t(e.options.components[a[0]],function(e){e?n.method=e:n.method=null,i?n.params=i:a[1]?n.params=d(a[1]):n.params=null,"number"==typeof o?window.history.go(o):window.location.hash="!"+o})})},n.vm=new e({el:o.el,data:{views:[]},template:'<div id="'+o.el.replace("#","")+'"><jt-view class="jtaro-view" v-for="view in views" :view="view"></jt-view></div>'}),window.addEventListener("hashchange",function(){u(window.location.hash,o.jroll)}),window.addEventListener("resize",p),window.addEventListener("orientationchange",p),n.boot=function(i){var l=window.location.hash,a=e.options.components[i||l.replace("#!","").split("?")[0]||"home"];a&&t(a,function(e){e?n.method=e:n.method=null,""===l?window.location.hash=i?"!"+i:"!home":u(l,o.jroll)})}},window.Vue&&window.JRoll&&window.Vue.use(n,{jroll:window.JRoll,el:"#jtaro_app"}),n});