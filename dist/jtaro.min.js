/*! JTaro.js v0.1.0 ~ (c) 2016 Author:BarZu Git:https://github.com/chjtx/JTaro */
!function(n,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):n.JTaro=e()}(this,function(){"use strict";var n=Object.create(null);return n.install=function(e,o){function t(e,o){var t=e.options.beforeEnter;"function"==typeof t?t.call(n,function(n){o(n)})&&o():o()}function i(o){var t=e.options.components[o.jtaro_tag].options.afterEnter;"function"==typeof t&&t.call(o,n.params)}function a(n,o){var t=e.options.components[n.$parent.jtaro_tag].options.beforeLeave;"function"==typeof t?t.call(n,function(){o()})&&o():o()}function l(e,o){var t=e.$el,a=t.previousElementSibling;n.method&&n.method.call(e,e),n.sliding=!0,o.utils.moveTo(t,h,0),setTimeout(function(){a&&o.utils.moveTo(a,-h*n.options.distance,0,300,function(){var n=a.previousElementSibling;n&&(n.style.display="none")}),o.utils.moveTo(t,0,0,300,function(){n.sliding=!1,i(e)})},0)}function s(e,o,t){var i=e.nextElementSibling;n.sliding=!0,i&&o.utils.moveTo(i,h,0,300,t),o.utils.moveTo(e,0,0,300,function(){n.sliding=!1;var o=e.previousElementSibling;o&&(o.style.display="block")})}function r(n,e,o,t){var a=n.length;a-1>t&&s(e[a-2],o,function(){n.splice(a-1),e[a-1].parentNode.removeChild(e[a-1]),setTimeout(function(){r(n,e,o,t)},0)}),a-1===t&&i(p(n[t]))}function d(n){var e=n.split("&"),o={};return e.forEach(function(n){var e=n.split("=");o[e[0]]=e[1]}),o}function p(e){for(var o=n.vm.$children,t=0,i=o.length;t<i;t++)if(o[t].jtaro_tag===e)return o[t]}function c(e,o){var t=e.replace("#!","").split("?")[0],i=n.vm.$data.views,a=n.views.indexOf(t),s=p(t);a===-1?(i.indexOf(t)===-1?i.push(t):(n.vm.$el.appendChild(s.$el),l(s,o)),n.views.push(t)):(n.method&&n.method.call(s,s),r(n.views,n.vm.$el.childNodes,o,a))}function u(){h=window.innerWidth}var f=document.getElementById("jtaro_style");f||(f=document.createElement("style"),f.id="jtaro_style",f.innerHTML="html,body{height:100%;padding:0;margin:0}#jtaro_app{position:relative;width:100%;height:100%;overflow:hidden}.jtaro-view{position:absolute;width:100%;height:100%;overflow:hidden;background:#fff}",document.head.appendChild(f));var v={template:'<div style="text-align:center;padding-top:100px">404 Page not found</div>'},h=window.innerWidth;n.params=null,n.views=[],n.version="0.1.0",n.options={default:"index",distance:.3};var m={props:["view"],data:function(){return{jtaro_tag:this.view}},render:function(n){return n(e.options.components[this.view]||v)},mounted:function(){l(this,o.jroll)}};e.component("jt-view",m),e.prototype.postMessage=function(n,o){var t=p(o),i=e.options.components[o],a=i?i.options.onMessage:null;t&&a&&a.call(t.$children[0],{message:n,origin:this.$parent.jtaro_tag})},e.prototype.go=function(o,i){n.sliding||a(this,function(){var a=o.replace("#!",""),l=a.split("?");t(e.options.components[l[0]],function(e){e?n.method=e:n.method=null,l[1]?n.params=d(l[1]):i?n.params=i:n.params=null,"number"==typeof o?window.history.go(o):window.location.hash="!"+o})})},n.vm=new e({el:o.el,data:{views:[]},template:'<div id="'+o.el.replace("#","")+'"><jt-view class="jtaro-view" v-for="view in views" :view="view"></jt-view></div>'}),window.addEventListener("hashchange",function(){c(window.location.hash,o.jroll)}),window.addEventListener("resize",u),window.addEventListener("orientationchange",u),n.boot=function(i){if(i)for(var a in i)n.options[a]=i[a];var l=window.location.hash,s=e.options.components[n.options.default||l.replace("#!","").split("?")[0]];s&&t(s,function(e){e?n.method=e:n.method=null,""===l?window.location.hash="!"+n.options.default:c(l,o.jroll)})}},window.Vue&&window.JRoll&&window.Vue.use(n,{jroll:window.JRoll,el:"#jtaro_app"}),n});