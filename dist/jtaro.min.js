/*! JTaro.js v0.1.2 ~ (c) 2016 Author:BarZu Git:https://github.com/chjtx/JTaro */
!function(n,o){"object"==typeof exports&&"undefined"!=typeof module?module.exports=o():"function"==typeof define&&define.amd?define(o):n.JTaro=o()}(this,function(){"use strict";var n=Object.create(null);return n.install=function(o,t){function e(o,t){var e=o.options.beforeEnter;"function"==typeof e?e.call(n,function(n){t(n)})&&t():t()}function i(t){var e=o.options.components[t.jtaro_tag].options.afterEnter;"function"==typeof e&&e.call(t,n.params)}function a(n,t){var e=o.options.components[n.$parent.jtaro_tag].options.beforeLeave;"function"==typeof e?e.call(n,function(){t()})&&t():t()}function l(o,t){var e=o.$el,a=e.previousElementSibling;n.method&&n.method.call(o,o),n.sliding=!0,t.utils.moveTo(e,h,0),setTimeout(function(){a&&t.utils.moveTo(a,-h*n.options.distance,0,n.options.duration,function(){var n=a.previousElementSibling;n&&(n.style.display="none")}),t.utils.moveTo(e,0,0,n.options.duration,function(){n.sliding=!1,i(o)})},0)}function s(o,t,e){var i=o.nextElementSibling;n.sliding=!0,i&&t.utils.moveTo(i,h,0,n.options.duration,e),t.utils.moveTo(o,0,0,n.options.duration,function(){n.sliding=!1;var t=o.previousElementSibling;t&&(t.style.display="block")})}function r(n,o,t,e){var a=n.length;a-1>e&&s(o[a-2],t,function(){n.splice(a-1),o[a-1].parentNode.removeChild(o[a-1]),setTimeout(function(){r(n,o,t,e)},0)}),a-1===e&&i(p(n[e]))}function d(n){var o=n.split("&"),t={};return o.forEach(function(n){var o=n.split("=");t[o[0]]=o[1]}),t}function p(o){for(var t=n.vm.$children,e=0,i=t.length;e<i;e++)if(t[e].jtaro_tag===o)return t[e]}function u(o,t){var e=o.replace("#!","").split("?")[0],i=n.vm.$data.views,a=n.views.indexOf(e),s=p(e);a===-1?(i.indexOf(e)===-1?i.push(e):(n.vm.$el.appendChild(s.$el),l(s,t)),n.views.push(e)):(n.method&&n.method.call(s,s),r(n.views,n.vm.$el.childNodes,t,a))}function c(){h=window.innerWidth}var f=document.getElementById("jtaro_style");f||(f=document.createElement("style"),f.id="jtaro_style",f.innerHTML="html,body{height:100%;padding:0;margin:0}#jtaro_app{position:relative;width:100%;height:100%;overflow:hidden}.jtaro-view{position:absolute;width:100%;height:100%;overflow:hidden;background:#fff}",document.head.appendChild(f));var v={template:'<div style="text-align:center;padding-top:100px">404 Page not found</div>'},h=window.innerWidth;t=t||{},n.params=null,n.views=[],n.version="0.1.2",n.options={JRoll:t.JRoll||window.JRoll,el:t.el||"#jtaro_app",default:t.default||"home",distance:t.distance||.3,duration:t.duration||200};var m={props:["view"],data:function(){return{jtaro_tag:this.view}},render:function(n){return n(o.options.components[this.view]||v)},mounted:function(){l(this,n.options.JRoll)}};o.component("jt-view",m),o.prototype.postMessage=function(n,t){var e=p(t),i=o.options.components[t],a=i?i.options.onMessage:null;e&&a&&a.call(e.$children[0],{message:n,origin:this.$parent.jtaro_tag})},o.prototype.go=function(t,i){n.sliding||a(this,function(){var a=t.replace("#!",""),l=a.split("?");e(o.options.components[l[0]],function(o){o?n.method=o:n.method=null,l[1]?n.params=d(l[1]):i?n.params=i:n.params=null,"number"==typeof t?window.history.go(t):window.location.hash="!"+t})})},n.vm=new o({el:n.options.el,data:{views:[]},template:'<div id="'+n.options.el.replace("#","")+'"><jt-view class="jtaro-view" v-for="view in views" :view="view"></jt-view></div>'}),window.addEventListener("hashchange",function(){u(window.location.hash,n.options.JRoll)}),window.addEventListener("resize",c),window.addEventListener("orientationchange",c),function(){var t=window.location.hash,i=o.options.components[n.options.default||t.replace("#!","").split("?")[0]];i&&e(i,function(o){o?n.method=o:n.method=null,""===t?window.location.hash="!"+n.options.default:u(t,n.options.JRoll)})}()},n});